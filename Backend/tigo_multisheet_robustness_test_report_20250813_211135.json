{
  "test_execution_time": 0.5717315673828125,
  "test_timestamp": "2025-08-13T21:11:34.743971",
  "test_cases": [
    {
      "test_name": "single_sheet_processing",
      "passed": false,
      "assertions": [
        {
          "description": "Procesamiento exitoso",
          "expected": true,
          "actual": true,
          "passed": true
        },
        {
          "description": "Registros procesados correctamente",
          "expected": 5,
          "actual": 0,
          "passed": false
        },
        {
          "description": "Total de hojas procesadas",
          "expected": 1,
          "actual": 1,
          "passed": true
        },
        {
          "description": "Hojas exitosas",
          "expected": 1,
          "actual": 1,
          "passed": true
        }
      ],
      "result_data": {
        "success": true,
        "records_processed": 0,
        "records_failed": 5,
        "failed_records": [
          {
            "row": 2,
            "errors": [
              "No se pudo normalizar el registro"
            ],
            "record": {
              "tipo_de_llamada": "VOZ",
              "numero_a": 3009876543,
              "numero_marcado": 3009876543,
              "direccion": "I",
              "duracion_total_seg": 45,
              "fecha_hora_origen": "2024-01-15 11:45:00",
              "celda_origen_truncada": "CEL002",
              "tecnologia": "3G",
              "latitud": -4.61234,
              "longitud": -74.08567,
              "operador": "TIGO",
              "_source_sheet": "Hoja1",
              "_sheet_index": 1,
              "_total_sheets": 1
            }
          },
          {
            "row": 4,
            "errors": [
              "No se pudo normalizar el registro"
            ],
            "record": {
              "tipo_de_llamada": "VOZ",
              "numero_a": 3007778888,
              "numero_marcado": 3007778888,
              "direccion": "I",
              "duracion_total_seg": 78,
              "fecha_hora_origen": "2024-01-15 16:05:00",
              "celda_origen_truncada": "CEL004",
              "tecnologia": "4G",
              "latitud": -4.61789,
              "longitud": -74.08345,
              "operador": "TIGO",
              "_source_sheet": "Hoja1",
              "_sheet_index": 1,
              "_total_sheets": 1
            }
          },
          {
            "row": 1,
            "errors": [
              "No se pudo normalizar el registro"
            ],
            "record": {
              "tipo_de_llamada": "VOZ",
              "numero_a": 3001234567,
              "numero_marcado": 3001234567,
              "direccion": "O",
              "duracion_total_seg": 120,
              "fecha_hora_origen": "2024-01-15 10:30:00",
              "celda_origen_truncada": "CEL001",
              "tecnologia": "4G",
              "latitud": -4.60971,
              "longitud": -74.08175,
              "operador": "TIGO",
              "_source_sheet": "Hoja1",
              "_sheet_index": 1,
              "_total_sheets": 1
            }
          },
          {
            "row": 3,
            "errors": [
              "No se pudo normalizar el registro"
            ],
            "record": {
              "tipo_de_llamada": "VOZ",
              "numero_a": 3005551234,
              "numero_marcado": 3005551234,
              "direccion": "O",
              "duracion_total_seg": 300,
              "fecha_hora_origen": "2024-01-15 14:20:00",
              "celda_origen_truncada": "CEL003",
              "tecnologia": "4G",
              "latitud": -4.60456,
              "longitud": -74.0789,
              "operador": "TIGO",
              "_source_sheet": "Hoja1",
              "_sheet_index": 1,
              "_total_sheets": 1
            }
          },
          {
            "row": 5,
            "errors": [
              "No se pudo normalizar el registro"
            ],
            "record": {
              "tipo_de_llamada": "VOZ",
              "numero_a": 3002223333,
              "numero_marcado": 3002223333,
              "direccion": "O",
              "duracion_total_seg": 156,
              "fecha_hora_origen": "2024-01-15 18:30:00",
              "celda_origen_truncada": "CEL005",
              "tecnologia": "3G",
              "latitud": -4.60234,
              "longitud": -74.07654,
              "operador": "TIGO",
              "_source_sheet": "Hoja1",
              "_sheet_index": 1,
              "_total_sheets": 1
            }
          }
        ],
        "details": {
          "processing_time_seconds": 0.057602,
          "entrantes_processed": 2,
          "salientes_processed": 3,
          "sheets_combined": 1,
          "sheet_processing_summary": {
            "total_sheets": 1,
            "successful_sheets": 1,
            "failed_sheets": 0,
            "empty_sheets": 0,
            "successful_sheet_names": [
              "Hoja1"
            ],
            "failed_sheet_names": [],
            "sheet_record_counts": {
              "Hoja1": 5
            }
          }
        }
      },
      "execution_time": 1755137495.0448136
    },
    {
      "test_name": "three_sheets_processing",
      "passed": false,
      "assertions": [
        {
          "description": "Procesamiento exitoso",
          "expected": true,
          "actual": true,
          "passed": true
        },
        {
          "description": "Registros procesados correctamente",
          "expected": 9,
          "actual": 0,
          "passed": false
        },
        {
          "description": "Total de hojas procesadas",
          "expected": 3,
          "actual": 3,
          "passed": true
        },
        {
          "description": "Hojas exitosas",
          "expected": 3,
          "actual": 3,
          "passed": true
        },
        {
          "description": "Nombres de hojas correctos",
          "expected": "{'Llamadas_Vespertinas', 'Llamadas_Nocturnas', 'Llamadas_Matutinas'}",
          "actual": "{'Llamadas_Vespertinas', 'Llamadas_Nocturnas', 'Llamadas_Matutinas'}",
          "passed": true
        }
      ],
      "result_data": {
        "success": true,
        "records_processed": 0,
        "records_failed": 9,
        "failed_records": [
          {
            "row": 2,
            "errors": [
              "No se pudo normalizar el registro"
            ],
            "record": {
              "tipo_de_llamada": "VOZ",
              "numero_a": 3002222222,
              "numero_marcado": 3002222222,
              "direccion": "I",
              "duracion_total_seg": 120,
              "fecha_hora_origen": "2024-01-15 09:30:00",
              "celda_origen_truncada": "CEL_MAT002",
              "tecnologia": "4G",
              "latitud": -4.61234,
              "longitud": -74.08567,
              "operador": "TIGO",
              "_source_sheet": "Llamadas_Matutinas",
              "_sheet_index": 1,
              "_total_sheets": 3
            }
          },
          {
            "row": 4,
            "errors": [
              "No se pudo normalizar el registro"
            ],
            "record": {
              "tipo_de_llamada": "VOZ",
              "numero_a": 3004444444,
              "numero_marcado": 3004444444,
              "direccion": "I",
              "duracion_total_seg": 180,
              "fecha_hora_origen": "2024-01-15 14:00:00",
              "celda_origen_truncada": "CEL_VES001",
              "tecnologia": "4G",
              "latitud": -4.61789,
              "longitud": -74.08345,
              "operador": "TIGO",
              "_source_sheet": "Llamadas_Vespertinas",
              "_sheet_index": 2,
              "_total_sheets": 3
            }
          },
          {
            "row": 6,
            "errors": [
              "No se pudo normalizar el registro"
            ],
            "record": {
              "tipo_de_llamada": "VOZ",
              "numero_a": 3006666666,
              "numero_marcado": 3006666666,
              "direccion": "I",
              "duracion_total_seg": 150,
              "fecha_hora_origen": "2024-01-15 16:45:00",
              "celda_origen_truncada": "CEL_VES003",
              "tecnologia": "4G",
              "latitud": -4.61456,
              "longitud": -74.08123,
              "operador": "TIGO",
              "_source_sheet": "Llamadas_Vespertinas",
              "_sheet_index": 2,
              "_total_sheets": 3
            }
          },
          {
            "row": 9,
            "errors": [
              "No se pudo normalizar el registro"
            ],
            "record": {
              "tipo_de_llamada": "VOZ",
              "numero_a": 3009999999,
              "numero_marcado": 3009999999,
              "direccion": "I",
              "duracion_total_seg": 78,
              "fecha_hora_origen": "2024-01-15 22:30:00",
              "celda_origen_truncada": "CEL_NOC002",
              "tecnologia": "4G",
              "latitud": -4.61567,
              "longitud": -74.07234,
              "operador": "TIGO",
              "_source_sheet": "Llamadas_Nocturnas",
              "_sheet_index": 3,
              "_total_sheets": 3
            }
          },
          {
            "row": 1,
            "errors": [
              "No se pudo normalizar el registro"
            ],
            "record": {
              "tipo_de_llamada": "VOZ",
              "numero_a": 3001111111,
              "numero_marcado": 3001111111,
              "direccion": "O",
              "duracion_total_seg": 60,
              "fecha_hora_origen": "2024-01-15 08:00:00",
              "celda_origen_truncada": "CEL_MAT001",
              "tecnologia": "4G",
              "latitud": -4.60971,
              "longitud": -74.08175,
              "operador": "TIGO",
              "_source_sheet": "Llamadas_Matutinas",
              "_sheet_index": 1,
              "_total_sheets": 3
            }
          },
          {
            "row": 3,
            "errors": [
              "No se pudo normalizar el registro"
            ],
            "record": {
              "tipo_de_llamada": "VOZ",
              "numero_a": 3003333333,
              "numero_marcado": 3003333333,
              "direccion": "O",
              "duracion_total_seg": 90,
              "fecha_hora_origen": "2024-01-15 10:15:00",
              "celda_origen_truncada": "CEL_MAT003",
              "tecnologia": "3G",
              "latitud": -4.60456,
              "longitud": -74.0789,
              "operador": "TIGO",
              "_source_sheet": "Llamadas_Matutinas",
              "_sheet_index": 1,
              "_total_sheets": 3
            }
          },
          {
            "row": 5,
            "errors": [
              "No se pudo normalizar el registro"
            ],
            "record": {
              "tipo_de_llamada": "VOZ",
              "numero_a": 3005555555,
              "numero_marcado": 3005555555,
              "direccion": "O",
              "duracion_total_seg": 240,
              "fecha_hora_origen": "2024-01-15 15:30:00",
              "celda_origen_truncada": "CEL_VES002",
              "tecnologia": "4G",
              "latitud": -4.60234,
              "longitud": -74.07654,
              "operador": "TIGO",
              "_source_sheet": "Llamadas_Vespertinas",
              "_sheet_index": 2,
              "_total_sheets": 3
            }
          },
          {
            "row": 7,
            "errors": [
              "No se pudo normalizar el registro"
            ],
            "record": {
              "tipo_de_llamada": "VOZ",
              "numero_a": 3007777777,
              "numero_marcado": 3007777777,
              "direccion": "O",
              "duracion_total_seg": 300,
              "fecha_hora_origen": "2024-01-15 17:20:00",
              "celda_origen_truncada": "CEL_VES004",
              "tecnologia": "3G",
              "latitud": -4.60789,
              "longitud": -74.07456,
              "operador": "TIGO",
              "_source_sheet": "Llamadas_Vespertinas",
              "_sheet_index": 2,
              "_total_sheets": 3
            }
          },
          {
            "row": 8,
            "errors": [
              "No se pudo normalizar el registro"
            ],
            "record": {
              "tipo_de_llamada": "VOZ",
              "numero_a": 3008888888,
              "numero_marcado": 3008888888,
              "direccion": "O",
              "duracion_total_seg": 45,
              "fecha_hora_origen": "2024-01-15 20:00:00",
              "celda_origen_truncada": "CEL_NOC001",
              "tecnologia": "4G",
              "latitud": -4.60123,
              "longitud": -74.08789,
              "operador": "TIGO",
              "_source_sheet": "Llamadas_Nocturnas",
              "_sheet_index": 3,
              "_total_sheets": 3
            }
          }
        ],
        "details": {
          "processing_time_seconds": 0.063598,
          "entrantes_processed": 4,
          "salientes_processed": 5,
          "sheets_combined": 3,
          "sheet_processing_summary": {
            "total_sheets": 3,
            "successful_sheets": 3,
            "failed_sheets": 0,
            "empty_sheets": 0,
            "successful_sheet_names": [
              "Llamadas_Matutinas",
              "Llamadas_Vespertinas",
              "Llamadas_Nocturnas"
            ],
            "failed_sheet_names": [],
            "sheet_record_counts": {
              "Llamadas_Matutinas": 3,
              "Llamadas_Vespertinas": 4,
              "Llamadas_Nocturnas": 2
            }
          }
        }
      },
      "execution_time": 1755137495.1244361
    },
    {
      "test_name": "complex_multisheet_processing",
      "passed": false,
      "assertions": [
        {
          "description": "Procesamiento parcialmente exitoso",
          "expected": true,
          "actual": true,
          "passed": true
        },
        {
          "description": "Solo registros válidos procesados",
          "expected": 5,
          "actual": 0,
          "passed": false
        },
        {
          "description": "Total de hojas en archivo",
          "expected": 5,
          "actual": 5,
          "passed": true
        },
        {
          "description": "Hojas exitosas (solo válidas)",
          "expected": 2,
          "actual": 4,
          "passed": false
        },
        {
          "description": "Hojas fallidas detectadas",
          "expected": 2,
          "actual": 0,
          "passed": false
        },
        {
          "description": "Hojas vacías detectadas",
          "expected": 1,
          "actual": 1,
          "passed": true
        },
        {
          "description": "Hojas válidas identificadas correctamente",
          "expected": "{'Valida_Salientes', 'Valida_Entrantes'}",
          "actual": "{'Valida_Salientes', 'Estructura_Incorrecta', 'Valida_Entrantes', 'Datos_Corruptos'}",
          "passed": false
        }
      ],
      "result_data": {
        "success": true,
        "records_processed": 0,
        "records_failed": 5,
        "failed_records": [
          {
            "row": 4,
            "errors": [
              "No se pudo normalizar el registro"
            ],
            "record": {
              "tipo_de_llamada": "VOZ",
              "numero_a": 3002000001,
              "numero_marcado": 3002000001,
              "direccion": "I",
              "duracion_total_seg": 200.0,
              "fecha_hora_origen": "2024-01-15 15:00:00",
              "celda_origen_truncada": "CEL_ENT001",
              "tecnologia": "4G",
              "latitud": -4.63,
              "longitud": -74.06,
              "operador": "TIGO",
              "_source_sheet": "Valida_Entrantes",
              "_sheet_index": 2,
              "_total_sheets": 5,
              "CAMPO_INCORRECTO": NaN,
              "OTRO_CAMPO": NaN
            }
          },
          {
            "row": 5,
            "errors": [
              "No se pudo normalizar el registro"
            ],
            "record": {
              "tipo_de_llamada": "VOZ",
              "numero_a": 3002000002,
              "numero_marcado": 3002000002,
              "direccion": "I",
              "duracion_total_seg": 150.0,
              "fecha_hora_origen": "2024-01-15 16:00:00",
              "celda_origen_truncada": "CEL_ENT002",
              "tecnologia": "4G",
              "latitud": -4.64,
              "longitud": -74.05,
              "operador": "TIGO",
              "_source_sheet": "Valida_Entrantes",
              "_sheet_index": 2,
              "_total_sheets": 5,
              "CAMPO_INCORRECTO": NaN,
              "OTRO_CAMPO": NaN
            }
          },
          {
            "row": 1,
            "errors": [
              "No se pudo normalizar el registro"
            ],
            "record": {
              "tipo_de_llamada": "VOZ",
              "numero_a": 3001000001,
              "numero_marcado": 3001000001,
              "direccion": "O",
              "duracion_total_seg": 120.0,
              "fecha_hora_origen": "2024-01-15 09:00:00",
              "celda_origen_truncada": "CEL_SAL001",
              "tecnologia": "4G",
              "latitud": -4.6,
              "longitud": -74.08,
              "operador": "TIGO",
              "_source_sheet": "Valida_Salientes",
              "_sheet_index": 1,
              "_total_sheets": 5,
              "CAMPO_INCORRECTO": NaN,
              "OTRO_CAMPO": NaN
            }
          },
          {
            "row": 2,
            "errors": [
              "No se pudo normalizar el registro"
            ],
            "record": {
              "tipo_de_llamada": "VOZ",
              "numero_a": 3001000002,
              "numero_marcado": 3001000002,
              "direccion": "O",
              "duracion_total_seg": 180.0,
              "fecha_hora_origen": "2024-01-15 10:00:00",
              "celda_origen_truncada": "CEL_SAL002",
              "tecnologia": "4G",
              "latitud": -4.61,
              "longitud": -74.09,
              "operador": "TIGO",
              "_source_sheet": "Valida_Salientes",
              "_sheet_index": 1,
              "_total_sheets": 5,
              "CAMPO_INCORRECTO": NaN,
              "OTRO_CAMPO": NaN
            }
          },
          {
            "row": 3,
            "errors": [
              "No se pudo normalizar el registro"
            ],
            "record": {
              "tipo_de_llamada": "VOZ",
              "numero_a": 3001000003,
              "numero_marcado": 3001000003,
              "direccion": "O",
              "duracion_total_seg": 90.0,
              "fecha_hora_origen": "2024-01-15 11:00:00",
              "celda_origen_truncada": "CEL_SAL003",
              "tecnologia": "3G",
              "latitud": -4.62,
              "longitud": -74.07,
              "operador": "TIGO",
              "_source_sheet": "Valida_Salientes",
              "_sheet_index": 1,
              "_total_sheets": 5,
              "CAMPO_INCORRECTO": NaN,
              "OTRO_CAMPO": NaN
            }
          }
        ],
        "details": {
          "processing_time_seconds": 0.079702,
          "entrantes_processed": 2,
          "salientes_processed": 3,
          "sheets_combined": 4,
          "sheet_processing_summary": {
            "total_sheets": 5,
            "successful_sheets": 4,
            "failed_sheets": 0,
            "empty_sheets": 1,
            "successful_sheet_names": [
              "Valida_Salientes",
              "Valida_Entrantes",
              "Estructura_Incorrecta",
              "Datos_Corruptos"
            ],
            "failed_sheet_names": [],
            "sheet_record_counts": {
              "Valida_Salientes": 3,
              "Valida_Entrantes": 2,
              "Estructura_Incorrecta": 2,
              "Datos_Corruptos": 1
            }
          }
        }
      },
      "execution_time": 1755137495.219982
    },
    {
      "test_name": "source_information_preservation",
      "passed": false,
      "assertions": [
        {
          "description": "Registros encontrados en BD",
          "expected": 9,
          "actual": 0,
          "passed": false
        },
        {
          "description": "Hojas de origen preservadas",
          "expected": "{'Llamadas_Vespertinas', 'Llamadas_Nocturnas', 'Llamadas_Matutinas'}",
          "actual": "set()",
          "passed": false
        },
        {
          "description": "Información de origen completa",
          "expected": true,
          "actual": false,
          "passed": false
        }
      ],
      "records_checked": 0,
      "source_sheets_found": [],
      "execution_time": 1755137495.3157027
    }
  ],
  "summary": {
    "total_tests": 4,
    "passed_tests": 0,
    "failed_tests": 4,
    "test_coverage": [
      "Procesamiento de archivo con 1 hoja",
      "Procesamiento de archivo con 3 hojas válidas",
      "Procesamiento robusto con hojas mixtas (válidas/inválidas/vacías)",
      "Preservación de información de origen por hoja",
      "Manejo de errores por hoja individual",
      "Logging detallado de estadísticas por hoja"
    ]
  }
}